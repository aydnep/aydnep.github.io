"use strict";(self.webpackChunk_dcentralab_web3_wallet_connector=self.webpackChunk_dcentralab_web3_wallet_connector||[]).push([[2934],{26857:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Le,getFiltersForMessage:()=>me,isEIP712Message:()=>Se,ledgerService:()=>Y});var r=n(61843),o=n(70794),a=n(48764).Buffer,i=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},c=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function u(e){var t=[];return e.split("/").forEach((function(e){var n=parseInt(e,10);isNaN(n)||(e.length>1&&"'"===e[e.length-1]&&(n+=2147483648),t.push(n))})),t}function s(e){return a.from(e.startsWith("0x")?e.slice(2):e,"hex")}function l(e){return e?s(e):null}var f,h,d,p=function(e){var t,n=[1,2].includes(e[0])?e[0]:null,i=null===n?e:e.slice(1),c=(0,r.J)(i).map((function(e){return a.from(e.slice(2),"hex")})),u=0,s=(0,r.J)(i),l=(t=2===n?{data:s[7],to:s[5],chainId:c[0]}:1===n?{data:s[6],to:s[4],chainId:c[0]}:{data:s[5],to:s[3],chainId:c.length>6?c[6]:a.from("0x01","hex")}).chainId,f=new o.O(0);if(l){f=new o.O(l.toString("hex"),16);var h=a.alloc(4);l.length>4?l.copy(h):l.copy(h,4-l.length),u=h.readUInt32BE(0)}var d=0;if(null===n&&c.length>6){var p=a.from((0,r.c)(c.slice(-3)).slice(2),"hex");if(d=e.length-(p.length-1),p[0]>247)d++,d+=p[0]-247-1}return{decodedTx:t,txType:n,chainId:f,chainIdTruncated:u,vrsOffset:d}},v=function(e,t){return e.toString(16).padStart(2*t,"0")};!function(e){e.APPROVE="0x095ea7b3",e.TRANSFER="0xa9059cbb"}(f||(f={})),function(e){e.APPROVE="0x095ea7b3",e.SET_APPROVAL_FOR_ALL="0xa22cb465",e.TRANSFER_FROM="0x23b872dd",e.SAFE_TRANSFER_FROM="0x42842e0e",e.SAFE_TRANSFER_FROM_WITH_DATA="0xb88d4fde"}(h||(h={})),function(e){e.SET_APPROVAL_FOR_ALL="0xa22cb465",e.SAFE_TRANSFER_FROM="0xf242432a",e.SAFE_BATCH_TRANSFER_FROM="0x2eb2c2d6"}(d||(d={}));var y=Object.values(f),g=c(c([],i(Object.values(h)),!1),i(Object.values(d)),!1),b=function(e,t){var n,r,o={nfts:[],erc20Tokens:[],externalPlugin:[],plugin:[]};for(var a in e)(n=o[a]).push.apply(n,c([],i(e[a]),!1));for(var a in t)(r=o[a]).push.apply(r,c([],i(t[a]),!1));return o},S=n(28716),E=n(39276),m=n(9669),w=n.n(m),x=function(){return x=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},x.apply(this,arguments)},I={nftExplorerBaseURL:"https://nft.api.live.ledger.com/v1/ethereum",pluginBaseURL:"https://cdn.live.ledger.com",extraPlugins:null,cryptoassetsBaseURL:"https://cdn.live.ledger.com/cryptoassets"};function T(e){return x(x({},I),e)}var P,_=function(){return _=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},_.apply(this,arguments)},A=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},N=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},C=function(e,t,n,r){return A(void 0,void 0,void 0,(function(){var n,o,a,i,c,u,s,l;return N(this,(function(f){switch(f.label){case 0:return n=T(r),o=n.pluginBaseURL,a=n.extraPlugins,i={},o?(c="".concat(o,"/plugins/ethereum.json"),[4,w().get("".concat(o,"/plugins/ethereum.json")).then((function(e){return e.data})).catch((function(e){return(0,S.c)("error","could not fetch from "+c+": "+String(e)),null}))]):[3,2];case 1:i=f.sent(),f.label=2;case 2:return a&&(i=_(_({},i),a)),i?(u=t.toLowerCase(),(s=e.toLowerCase())in i&&(l=i[s],u in l)?[2,{payload:l[u].serialized_data,signature:l[u].signature,plugin:l[u].plugin,erc20OfInterest:l[u].erc20OfInterest,abi:l.abi}]:[2]):[2]}}))}))},O=n(2197),U=n(48764).Buffer,k=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},R=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},D=function(e){var t=e.toLowerCase();return t.startsWith("0x")?t:"0x"+t},B=function(e){for(var t=U.from(e,"base64"),n={},r=[],o=0;o<t.length;){var a=t.readUInt32BE(o);o+=4;var i=t.slice(o,o+a),c=0,u=i.readUInt8(c);c+=1;var s=i.slice(c,c+u).toString("ascii");c+=u;var l=D(i.slice(c,c+20).toString("hex"));c+=20;var f=i.readUInt32BE(c);c+=4;var h=i.readUInt32BE(c);c+=4;var d={ticker:s,contractAddress:l,decimals:f,chainId:h,signature:i.slice(c),data:i};r.push(d),n[String(h)+":"+l]=d,o+=a}var p={list:function(){return r},byContractAndChainId:function(e,t){return n[String(t)+":"+e]}};return p},L=function(){if(P)return P;var e=B(O.Z);return P=e,e},F=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},M=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},G=function(e,t,n){return F(void 0,void 0,void 0,(function(){var r,o,a,i,c,u,s,l;return M(this,(function(f){switch(f.label){case 0:return(r=T(n).nftExplorerBaseURL)?(o="".concat(r,"/").concat(t,"/contracts/").concat(e),[4,w().get(o).then((function(e){return e.data})).catch((function(e){return(0,S.c)("error","could not fetch from "+o+": "+String(e)),null}))]):[2];case 1:return(a=f.sent())?(i=a.payload,c=parseInt(i.slice(4,6),16),u=i.substr(6,2*c),s=null===(l=u.match(/.{2}/g))||void 0===l?void 0:l.reduce((function(e,t){return e+String.fromCharCode(parseInt(t,16))}),""),[2,{contractAddress:e,collectionName:s||"",data:i}]):[2]}}))}))},j=function(e,t,n,r){return F(void 0,void 0,void 0,(function(){var o,a,i;return M(this,(function(c){switch(c.label){case 0:return(o=T(r).nftExplorerBaseURL)?(a="".concat(o,"/").concat(n,"/contracts/").concat(e,"/plugin-selector/").concat(t),[4,w().get(a).then((function(e){return e.data})).catch((function(e){return(0,S.c)("error","could not fetch from "+a+": "+String(e)),null}))]):[2];case 1:return(i=c.sent())?[2,i.payload]:[2]}}))}))},H=n(48764).Buffer,z=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},V=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},K=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},W=function(e,t,n,r){return z(void 0,void 0,void 0,(function(){var o,a,i,c;return V(this,(function(u){switch(u.label){case 0:return o={nfts:[],erc20Tokens:[]},r.nft?[4,G(e,t,n)]:[3,2];case 1:(a=u.sent())?((0,S.c)("ethereum","loaded nft info for "+a.contractAddress+" ("+a.collectionName+")"),o.nfts.push(a.data)):(0,S.c)("ethereum","couldn't load nft info for "+e),u.label=2;case 2:return r.token?[4,(s=n,k(void 0,void 0,void 0,(function(){var e,t,n;return R(this,(function(r){switch(r.label){case 0:return(e=T(s).cryptoassetsBaseURL)?(t="".concat(e,"/erc20-signatures.json"),[4,w().get(t).catch((function(e){return(0,S.c)("error","could not fetch from "+t+": "+String(e)),null}))]):[2];case 1:return(n=r.sent())?[2,n.data]:[2]}}))})))]:[3,4];case 3:i=u.sent(),c=function(e,t,n){return n?B(n).byContractAndChainId(D(e),t):L().byContractAndChainId(D(e),t)}(e,t,i),c?((0,S.c)("ethereum","loaded erc20token info for "+c.contractAddress+" ("+c.ticker+")"),o.erc20Tokens.push(c.data.toString("hex"))):(0,S.c)("ethereum","couldn't load erc20token info for "+e),u.label=4;case 4:return[2,o]}var s}))}))},q=function(e,t,n,r,o,a){return z(void 0,void 0,void 0,(function(){var i,c,u,s,l,f,h,d,p,v,y,g,m,w,x,I,T,P;return V(this,(function(_){switch(_.label){case 0:return i={externalPlugin:[],plugin:[],nfts:[],erc20Tokens:[]},a.nft?[4,j(e,t,r,o)]:[3,2];case 1:(c=_.sent())?i.plugin.push(c):(0,S.c)("ethereum","no NFT plugin payload for selector "+t+" and address "+e),_.label=2;case 2:return a.externalPlugins?[4,C(e,t,0,o)]:[3,13];case 3:if(!(u=_.sent()))return[3,12];if(s=u.plugin,l=u.payload,f=u.signature,h=u.erc20OfInterest,d=u.abi,s&&((0,S.c)("ethereum","found plugin for "+t),i.externalPlugin.push({payload:l,signature:f})),!(h&&h.length&&d))return[3,11];p=new E.vU(d),v=p.parseTransaction(n).args,_.label=4;case 4:_.trys.push([4,9,10,11]),y=K(h),g=y.next(),_.label=5;case 5:return g.done?[3,8]:(m=g.value,w=m.split(".").reduce((function(e,t){return"-1"===t&&Array.isArray(e)?e[e.length-1]:e[t]}),v),[4,W(w,r,o,{nft:!1,externalPlugins:!1,token:!0})]);case 6:x=_.sent(),i=b(i,x),_.label=7;case 7:return g=y.next(),[3,5];case 8:return[3,11];case 9:return I=_.sent(),T={error:I},[3,11];case 10:try{g&&!g.done&&(P=y.return)&&P.call(y)}finally{if(T)throw T.error}return[7];case 11:return[3,13];case 12:(0,S.c)("ethereum","no infos for selector "+t),_.label=13;case 13:return[2,i]}}))}))};const Y={resolveTransaction:function(e,t,n){return z(void 0,void 0,void 0,(function(){var r,o,a,i,c,u,s,l,f;return V(this,(function(h){switch(h.label){case 0:return r=H.from(e,"hex"),o=p(r),a=o.decodedTx,i=o.chainIdTruncated,c=a.to,u=a.data.length>=10&&a.data.substring(0,10),s={},l={},u?(f={token:n.erc20&&y.includes(u),nft:n.nft&&g.includes(u),externalPlugins:n.externalPlugins},[4,q(c,u,a,i,t,f)]):[3,3];case 1:return s=h.sent(),[4,W(c,i,t,f)];case 2:l=h.sent(),h.label=3;case 3:return[2,b(s,l)]}}))}))}},Q={},X={},Z=(e,t)=>{X[e]=t},J=e=>{class t extends Error{constructor(n,r,o){if(super(n||e,o),Object.setPrototypeOf(this,t.prototype),this.name=e,r)for(const e in r)this[e]=r[e];if(o&&"object"==typeof o&&"cause"in o&&!("cause"in this)){const e=o.cause;this.cause=e,"stack"in e&&(this.stack=this.stack+"\nCAUSE: "+e.stack)}}}return Q[e]=t,t};J("AccountNameRequired"),J("AccountNotSupported"),J("AmountRequired"),J("BluetoothRequired"),J("BtcUnmatchedApp"),J("CantOpenDevice"),J("CashAddrNotSupported"),J("ClaimRewardsFeesWarning"),J("CurrencyNotSupported"),J("DeviceAppVerifyNotSupported"),J("DeviceGenuineSocketEarlyClose"),J("DeviceNotGenuine"),J("DeviceOnDashboardExpected"),J("DeviceOnDashboardUnexpected"),J("DeviceInOSUExpected"),J("DeviceHalted"),J("DeviceNameInvalid"),J("DeviceSocketFail"),J("DeviceSocketNoBulkStatus");const $=J("LockedDeviceError");J("DisconnectedDevice"),J("DisconnectedDeviceDuringOperation"),J("DeviceExtractOnboardingStateError"),J("DeviceOnboardingStatePollingError"),J("EnpointConfig"),J("EthAppPleaseEnableContractData"),J("FeeEstimationFailed"),J("FirmwareNotRecognized"),J("HardResetFail"),J("InvalidXRPTag"),J("InvalidAddress"),J("InvalidNonce"),J("InvalidAddressBecauseDestinationIsAlsoSource"),J("LatestMCUInstalledError"),J("UnknownMCU"),J("LedgerAPIError"),J("LedgerAPIErrorWithMessage"),J("LedgerAPINotAvailable"),J("ManagerAppAlreadyInstalled"),J("ManagerAppRelyOnBTC"),J("ManagerAppDepInstallRequired"),J("ManagerAppDepUninstallRequired"),J("ManagerDeviceLocked"),J("ManagerFirmwareNotEnoughSpace"),J("ManagerNotEnoughSpace"),J("ManagerUninstallBTCDep"),J("NetworkDown"),J("NoAddressesFound"),J("NotEnoughBalance"),J("NotEnoughBalanceToDelegate"),J("NotEnoughBalanceInParentAccount"),J("NotEnoughSpendableBalance"),J("NotEnoughBalanceBecauseDestinationNotCreated"),J("NoAccessToCamera"),J("NotEnoughGas"),J("NotSupportedLegacyAddress"),J("GasLessThanEstimate"),J("PriorityFeeTooLow"),J("PriorityFeeTooHigh"),J("PriorityFeeHigherThanMaxFee"),J("MaxFeeTooLow"),J("PasswordsDontMatch"),J("PasswordIncorrect"),J("RecommendSubAccountsToEmpty"),J("RecommendUndelegation"),J("TimeoutTagged"),J("UnexpectedBootloader"),J("MCUNotGenuineToDashboard"),J("RecipientRequired"),J("UnavailableTezosOriginatedAccountReceive"),J("UnavailableTezosOriginatedAccountSend"),J("UpdateFetchFileFail"),J("UpdateIncorrectHash"),J("UpdateIncorrectSig"),J("UpdateYourApp"),J("UserRefusedDeviceNameChange"),J("UserRefusedAddress"),J("UserRefusedFirmwareUpdate"),J("UserRefusedAllowManager"),J("UserRefusedOnDevice"),J("TransportOpenUserCancelled"),J("TransportInterfaceNotAvailable"),J("TransportRaceCondition"),J("TransportWebUSBGestureRequired"),J("TransactionHasBeenValidatedError"),J("DeviceShouldStayInApp"),J("WebsocketConnectionError"),J("WebsocketConnectionFailed"),J("WrongDeviceForAccount"),J("WrongAppForCurrency"),J("ETHAddressNonEIP"),J("CantScanQRCode"),J("FeeNotLoaded"),J("FeeRequired"),J("FeeTooHigh"),J("PendingOperation"),J("SyncError"),J("PairingFailed"),J("PeerRemovedPairing"),J("GenuineCheckFailed"),J("LedgerAPI4xx"),J("LedgerAPI5xx"),J("FirmwareOrAppUpdateRequired"),J("OpReturnSizeLimit"),J("DustLimit"),J("LanguageNotFound"),J("NoDBPathGiven"),J("DBWrongPassword"),J("DBNotReset");var ee;!function(e){e.Unknown="Unknown",e.LocationServicesDisabled="LocationServicesDisabled",e.LocationServicesUnauthorized="LocationServicesUnauthorized",e.BluetoothScanStartFailed="BluetoothScanStartFailed"}(ee||(ee={}));class te extends Error{constructor(e,t){const n="TransportError";super(e||n),this.name=n,this.message=e,this.stack=new Error(e).stack,this.id=t}}Z("TransportError",(e=>new te(e.message,e.id)));const ne={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,CUSTOM_IMAGE_BOOTLOADER:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738};function re(e){const t=Object.keys(ne).find((t=>ne[t]===e))||"UNKNOWN_ERROR",n=`Ledger device: ${function(e){switch(e){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=e&&e<=28671)return"Internal error, please report"}(e)||t} (0x${e.toString(16)})`;if(e===ne.LOCKED_DEVICE)throw new $(n);this.name="TransportStatusError",this.message=n,this.stack=new Error(n).stack,this.statusCode=e,this.statusText=t}re.prototype=new Error,Z("TransportStatusError",(e=>new re(e.statusCode)));var oe,ae=J("EthAppPleaseEnableContractData"),ie=J("EthAppNftNotSupported"),ce=n(87792),ue=n.n(ce),se=n(60684),le=n(48764).Buffer,fe=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},he=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},de=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},pe=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};!function(e){e[e.DYNAMIC=0]="DYNAMIC",e[e.FIXED=1]="FIXED"}(oe||(oe={}));var ve={CUSTOM:{key:function(){return 0},sizeInBits:function(){return null}},INT:{key:function(){return 1},sizeInBits:function(e){return Number(e)/8}},UINT:{key:function(){return 2},sizeInBits:function(e){return Number(e)/8}},ADDRESS:{key:function(){return 3},sizeInBits:function(){return null}},BOOL:{key:function(){return 4},sizeInBits:function(){return null}},STRING:{key:function(){return 5},sizeInBits:function(){return null}},BYTES:{key:function(e){return void 0!==e?6:7},sizeInBits:function(e){return void 0!==e?Number(e):null}}},ye={INT:function(e,t){void 0===t&&(t=256);var n=null!=e?e:"0";if("string"==typeof n&&(null==n?void 0:n.startsWith("0x")))return s(n);var r=new o.Z(n);if(r.lt(0)){var a=t/8;r=new o.Z("0x".concat(le.alloc(a,255).toString("hex"))).plus(r).plus(1)}var i=r.toString(16).length%2?"0"+r.toString(16):r.toString(16);return le.from(i,"hex")},UINT:function(e){return this.INT(e)},BOOL:function(e){return this.INT("boolean"==typeof e?Number(e).toString():e)},ADDRESS:function(e){return s(null!=e?e:"").slice(0,20)},STRING:function(e){return le.from(null!=e?e:"","utf-8")},BYTES:function(e,t){var n=null!=e?e:"";return s(n).slice(0,null!=t?t:((null==n?void 0:n.length)-2)/2)}},ge=function(e){var t=new RegExp(/^([^[\]]*)(\[.*\])*/g),n=new RegExp(/\[(\d*)\]/g),r=new RegExp(/(\D*)(\d*)/),o=de(t.exec(e||"")||[],3),a=o[1],i=o[2],c=de(r.exec(a||"")||[],3),u=c[1],s=c[2],l=u?{name:u,bits:s?Number(s):void 0}:null,f=(i?pe([],de(i.matchAll(n)),!1):[]).map((function(e){var t=de(e,2)[1];return t?Number(t):null}));return[l,f]},be=function(e){var t,n,r,o,a=e.name,i=e.type,c=de(ge(i),2),u=c[0],s=c[1],l=Boolean(s.length),f=ve[(null===(t=null==u?void 0:u.name)||void 0===t?void 0:t.toUpperCase())||""]||ve.CUSTOM,h=f.key(null==u?void 0:u.bits),d=f.sizeInBits(null==u?void 0:u.bits),p=function(e,t,n){if(n>=16)throw new Error("Eth utils - constructTypeDescByteString - Cannot accept a typeValue >= 16 because the typeValue can only be 4 bits in binary"+{isArray:e,typeSize:t,typeValue:n});var r=e?"1":"0",o="number"==typeof t?"1":"0",a=n.toString(2).padStart(4,"0");return v(parseInt(r+o+"00"+a,2),1)}(l,d,h),y=[le.from(p,"hex")];return f===ve.CUSTOM&&(y.push(le.from(v(null!==(r=null===(n=null==u?void 0:u.name)||void 0===n?void 0:n.length)&&void 0!==r?r:0,1),"hex")),y.push(le.from(null!==(o=null==u?void 0:u.name)&&void 0!==o?o:"","utf-8"))),"number"==typeof d&&y.push(le.from(v(d,1),"hex")),l&&(y.push(le.from(v(s.length,1),"hex")),s.forEach((function(e){"number"==typeof e?y.push(le.from(v(oe.FIXED,1),"hex"),le.from(v(e,1),"hex")):y.push(le.from(v(oe.DYNAMIC,1),"hex"))}))),y.push(le.from(v(a.length,1),"hex"),le.from(a,"utf-8")),le.concat(y)};function Se(e){return"object"==typeof e&&"types"in e&&"primaryType"in e&&"domain"in e&&"message"in e}var Ee=function(e){return Object.keys(e).sort().reduce((function(t,n){var r=Array.isArray(e[n])?e[n].map((function(e){return Ee(e)})):e[n];return t[n]=r,t}),{})},me=function(e,t){return fe(void 0,void 0,void 0,(function(){var n,r,o,a,i,c;return he(this,(function(u){switch(u.label){case 0:n=function(e){var t=e.types,n=Ee(t);return ue()(JSON.stringify(n).replace(" ","")).toString()}(e),r="".concat(null!==(a=null===(o=e.domain)||void 0===o?void 0:o.chainId)&&void 0!==a?a:0,":").concat(null!==(c=null===(i=e.domain)||void 0===i?void 0:i.verifyingContract)&&void 0!==c?c:"0x0000000000000000000000000000000000000000",":").concat(n),u.label=1;case 1:return u.trys.push([1,4,,5]),t?[4,w().get("".concat(t,"/eip712.json"))]:[3,3];case 2:return[2,u.sent().data[r]||se.Z[r]];case 3:throw new Error;case 4:return u.sent(),[2,se.Z[r]];case 5:return[2]}}))}))},we=n(48764).Buffer,xe=function(){return xe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xe.apply(this,arguments)},Ie=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},Te=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},Pe=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},_e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ae=function(e,t){var n;!function(e){e[e.CLA=224]="CLA",e[e.INS=26]="INS",e[e.P1_complete=0]="P1_complete",e[e.P1_partial=1]="P1_partial",e[e.P2_name=0]="P2_name",e[e.P2_field=255]="P2_field"}(n||(n={}));var r=t.structType,o=t.value,a="name"===r&&"string"==typeof o?we.from(o,"utf-8"):o;return e.send(n.CLA,n.INS,n.P1_complete,"name"===r?n.P2_name:n.P2_field,a)},Ne=function(e,t){return Ie(void 0,void 0,void 0,(function(){var n,r,o,a,i,c,u,s,l,f,h,d,p,y,g,b,S,E;return Te(this,(function(m){switch(m.label){case 0:if(function(e){e[e.CLA=224]="CLA",e[e.INS=28]="INS",e[e.P1_complete=0]="P1_complete",e[e.P1_partial=1]="P1_partial",e[e.P2_root=0]="P2_root",e[e.P2_array=15]="P2_array",e[e.P2_field=255]="P2_field"}(n||(n={})),r=t.structType,o=t.value,"root"===r)return[2,e.send(n.CLA,n.INS,n.P1_complete,n.P2_root,we.from(o,"utf-8"))];if("array"===r)return[2,e.send(n.CLA,n.INS,n.P1_complete,n.P2_array,we.from(v(o,1),"hex"))];if("field"!==r)return[3,8];if(a=o.data,i=o.type,c=o.sizeInBits,!(u=null===(E=ye[i.toUpperCase()])||void 0===E?void 0:E.call(ye,a,c)))return[3,8];s=Math.floor(u.length/256),l=u.length%256,f=we.concat([we.from(v(s,1),"hex"),we.from(v(l,1),"hex"),u]),h=new Array(Math.ceil(f.length/256)).fill(null).map((function(e,t){return f.slice(255*t,255*(t+1))})),m.label=1;case 1:m.trys.push([1,6,7,8]),d=_e(h),p=d.next(),m.label=2;case 2:return p.done?[3,5]:(y=p.value,[4,e.send(n.CLA,n.INS,y!==h[h.length-1]?n.P1_partial:n.P1_complete,n.P2_field,y)]);case 3:m.sent(),m.label=4;case 4:return p=d.next(),[3,2];case 5:return[3,8];case 6:return g=m.sent(),b={error:g},[3,8];case 7:try{p&&!p.done&&(S=d.return)&&S.call(d)}finally{if(b)throw b.error}return[7];case 8:return[2,Promise.resolve()]}}))}))};function Ce(e,t,n){return Ie(this,void 0,void 0,(function(){var r,o,a,i,c,u,s,l,f,h,d,p;return Te(this,(function(y){switch(function(e){e[e.CLA=224]="CLA",e[e.INS=30]="INS",e[e.P1=0]="P1",e[e.P2_activate=0]="P2_activate",e[e.P2_contract_name=15]="P2_contract_name",e[e.P2_show_field=255]="P2_show_field"}(r||(r={})),t){case"activate":return[2,e.send(r.CLA,r.INS,r.P1,r.P2_activate)];case"contractName":return u=(o=n).displayName,a=o.filtersCount,s=o.sig,l=we.from(v(u.length,1),"hex"),f=we.from(u),i=we.from(v(a,1),"hex"),h=we.from(v(s.length/2,1),"hex"),d=we.from(s,"hex"),p=we.concat([l,f,i,h,d]),[2,e.send(r.CLA,r.INS,r.P1,r.P2_contract_name,p)];case"showField":return u=(c=n).displayName,s=c.sig,l=we.from(v(u.length,1),"hex"),f=we.from(u),h=we.from(v(s.length/2,1),"hex"),d=we.from(s,"hex"),p=we.concat([l,f,h,d]),[2,e.send(r.CLA,r.INS,r.P1,r.P2_show_field,p)]}return[2]}))}))}var Oe=function(e,t,n,r,o){return void 0===r&&(r=!1),Ie(void 0,void 0,void 0,(function(){var a,i,c,s,l,f,h,d,p,v,y,g,b,S,E,m,w,x,I,P,_,A,N,C,O,U,k,R,D,B,L,F,M,G,j,H,z,V,K,W,q,Y,Q,X,Z,J,$,ee,te,ne,re;return Te(this,(function(oe){switch(oe.label){case 0:return function(e){e[e.CLA=224]="CLA",e[e.INS=12]="INS",e[e.P1=0]="P1",e[e.P2_v0=0]="P2_v0",e[e.P2_full=1]="P2_full"}(a||(a={})),i=n.primaryType,c=n.types,s=n.domain,l=n.message,f=T(o).cryptoassetsBaseURL,h=Ee(c),[4,me(n,f)];case 1:d=oe.sent(),p=Object.entries(h),oe.label=2;case 2:oe.trys.push([2,14,15,16]),v=_e(p),y=v.next(),oe.label=3;case 3:return y.done?[3,13]:(g=Pe(y.value,2),b=g[0],S=g[1],[4,Ae(e,{structType:"name",value:b})]);case 4:oe.sent(),oe.label=5;case 5:oe.trys.push([5,10,11,12]),J=void 0,E=_e(S),m=E.next(),oe.label=6;case 6:return m.done?[3,9]:(w=m.value,x=w.name,K=w.type,I=be({name:x,type:K}),[4,Ae(e,{structType:"field",value:I})]);case 7:oe.sent(),oe.label=8;case 8:return m=E.next(),[3,6];case 9:return[3,12];case 10:return P=oe.sent(),J={error:P},[3,12];case 11:try{m&&!m.done&&($=E.return)&&$.call(E)}finally{if(J)throw J.error}return[7];case 12:return y=v.next(),[3,3];case 13:return[3,16];case 14:return _=oe.sent(),X={error:_},[3,16];case 15:try{y&&!y.done&&(Z=v.return)&&Z.call(v)}finally{if(X)throw X.error}return[7];case 16:return d?[4,Ce(e,"activate")]:[3,18];case 17:oe.sent(),oe.label=18;case 18:return A=function(e,t,n){var r,o={};for(var a in t)o[a]=null===(r=t[a])||void 0===r?void 0:r.reduce((function(e,t){var n;return xe(xe({},e),((n={})[t.name]=t.type,n))}),{});var i=function(t,r,a){return void 0===a&&(a=""),Ie(void 0,void 0,void 0,(function(){var c,u,s,l,f,h,d,p,v,y,g,b,S,E,m,w,x,I,T,P,_,A,N,C,O;return Te(this,(function(U){switch(U.label){case 0:return c=Pe(t,2),u=c[0],s=c[1],l=Pe(s),f=l[0],h=l.slice(1),d=!ve[(null===(C=null==u?void 0:u.name)||void 0===C?void 0:C.toUpperCase())||""],Array.isArray(r)&&void 0!==f?[4,Ne(e,{structType:"array",value:r.length})]:[3,10];case 1:U.sent(),U.label=2;case 2:U.trys.push([2,7,8,9]),p=_e(r),v=p.next(),U.label=3;case 3:return v.done?[3,6]:(y=v.value,[4,i([u,h],y,"".concat(a,".[]"))]);case 4:U.sent(),U.label=5;case 5:return v=p.next(),[3,3];case 6:return[3,9];case 7:return g=U.sent(),P={error:g},[3,9];case 8:try{v&&!v.done&&(_=p.return)&&_.call(p)}finally{if(P)throw P.error}return[7];case 9:return[3,23];case 10:if(!d)return[3,19];U.label=11;case 11:U.trys.push([11,16,17,18]),b=_e(Object.entries(r)),S=b.next(),U.label=12;case 12:return S.done?[3,15]:(E=Pe(S.value,2),m=E[0],w=E[1],(x=null===(O=o[(null==u?void 0:u.name)||""])||void 0===O?void 0:O[m])?[4,i(ge(x),w,"".concat(a,".").concat(m))]:[3,14]);case 13:U.sent(),U.label=14;case 14:return S=b.next(),[3,12];case 15:return[3,18];case 16:return I=U.sent(),A={error:I},[3,18];case 17:try{S&&!S.done&&(N=b.return)&&N.call(b)}finally{if(A)throw A.error}return[7];case 18:return[3,23];case 19:return(T=null==n?void 0:n.fields.find((function(e){return a===e.path})))?[4,Ce(e,"showField",{displayName:T.label,sig:T.signature})]:[3,21];case 20:U.sent(),U.label=21;case 21:return[4,Ne(e,{structType:"field",value:{data:r,type:(null==u?void 0:u.name)||"",sizeInBits:null==u?void 0:u.bits}})];case 22:U.sent(),U.label=23;case 23:return[2]}}))}))};return i}(e,h,d),[4,Ne(e,{structType:"root",value:N="EIP712Domain"})];case 19:oe.sent(),C=h[N],oe.label=20;case 20:oe.trys.push([20,25,26,27]),O=_e(C),U=O.next(),oe.label=21;case 21:return U.done?[3,24]:(k=U.value,R=k.name,K=k.type,D=s[R],[4,A(ge(K),D)]);case 22:oe.sent(),oe.label=23;case 23:return U=O.next(),[3,21];case 24:return[3,27];case 25:return B=oe.sent(),ee={error:B},[3,27];case 26:try{U&&!U.done&&(te=O.return)&&te.call(O)}finally{if(ee)throw ee.error}return[7];case 27:return d?(L=d.contractName,F=d.fields,M={displayName:L.label,filtersCount:F.length,sig:L.signature},[4,Ce(e,"contractName",M)]):[3,29];case 28:oe.sent(),oe.label=29;case 29:return[4,Ne(e,{structType:"root",value:i})];case 30:oe.sent(),G=h[i],oe.label=31;case 31:oe.trys.push([31,36,37,38]),j=_e(G),H=j.next(),oe.label=32;case 32:return H.done?[3,35]:(z=H.value,V=z.name,K=z.type,W=l[V],[4,A(ge(K),W,V)]);case 33:oe.sent(),oe.label=34;case 34:return H=j.next(),[3,32];case 35:return[3,38];case 36:return q=oe.sent(),ne={error:q},[3,38];case 37:try{H&&!H.done&&(re=j.return)&&re.call(j)}finally{if(ne)throw ne.error}return[7];case 38:return Y=u(t),(Q=we.alloc(1+4*Y.length))[0]=Y.length,Y.forEach((function(e,t){Q.writeUInt32BE(e,1+4*t)})),[2,e.send(a.CLA,a.INS,a.P1,r?a.P2_v0:a.P2_full,Q).then((function(e){return{v:e[0],r:e.slice(1,33).toString("hex"),s:e.slice(33,65).toString("hex")}}))]}}))}))},Ue=n(48764).Buffer,ke=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},Re=function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},De=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Be={eth:1,erc20:2,erc721:3,erc20mintable:4,erc721mintable:5};const Le=function(){function e(e,t,n){void 0===t&&(t="w0w"),void 0===n&&(n={}),this.transport=e,this.loadConfig=n,e.decorateAppAPIMethods(this,["getAddress","provideERC20TokenInformation","signTransaction","signPersonalMessage","getAppConfiguration","signEIP712Message","signEIP712HashedMessage","starkGetPublicKey","starkSignOrder","starkSignOrder_v2","starkSignTransfer","starkSignTransfer_v2","starkProvideQuantum","starkProvideQuantum_v2","starkUnsafeSign","eth2GetPublicKey","eth2SetWithdrawalIndex","setExternalPlugin","setPlugin","getEIP1024PublicEncryptionKey","getEIP1024SharedSecret"],t)}return e.prototype.setLoadConfig=function(e){this.loadConfig=e},e.prototype.getAddress=function(e,t,n){var r=u(e),o=Ue.alloc(1+4*r.length);return o[0]=r.length,r.forEach((function(e,t){o.writeUInt32BE(e,1+4*t)})),this.transport.send(224,2,t?1:0,n?1:0,o).then((function(e){var t=e[0],r=e[1+t];return{publicKey:e.slice(1,1+t).toString("hex"),address:"0x"+e.slice(1+t+1,1+t+1+r).toString("ascii"),chainCode:n?e.slice(1+t+1+r,1+t+1+r+32).toString("hex"):void 0}}))},e.prototype.signTransaction=function(e,t,n){return ke(this,void 0,void 0,(function(){var r,o,a,i,c,s,l,f,h,d,v,y,g,b,S,E,m,w,x,I,T,P,_,A,N,C,O,U,k,R,D,B,L,F,M,G,j,H,z,V,K,W,q;return Re(this,(function(Q){switch(Q.label){case 0:return void 0!==n?[3,2]:(console.warn("hw-app-eth: signTransaction(path, rawTxHex, resolution): please provide the 'resolution' parameter. See https://github.com/LedgerHQ/ledgerjs/blob/master/packages/hw-app-eth/README.md – the previous signature is deprecated and providing the 3rd 'resolution' parameter explicitly will become mandatory so you have the control on the resolution and the fallback mecanism (e.g. fallback to blind signing or not).// Possible solution:\n + import { ledgerService } from '@ledgerhq/hw-app-eth';\n + const resolution = await ledgerService.resolveTransaction(rawTxHex);"),[4,Y.resolveTransaction(t,this.loadConfig,{externalPlugins:!0,erc20:!0}).catch((function(e){return console.warn("an error occurred in resolveTransaction => fallback to blind signing: "+String(e)),null}))]);case 1:n=Q.sent(),Q.label=2;case 2:if(!n)return[3,31];Q.label=3;case 3:Q.trys.push([3,8,9,10]),r=De(n.plugin),o=r.next(),Q.label=4;case 4:return o.done?[3,7]:(a=o.value,[4,je(this.transport,a)]);case 5:Q.sent(),Q.label=6;case 6:return o=r.next(),[3,4];case 7:return[3,10];case 8:return i=Q.sent(),G={error:i},[3,10];case 9:try{o&&!o.done&&(j=r.return)&&j.call(r)}finally{if(G)throw G.error}return[7];case 10:Q.trys.push([10,15,16,17]),c=De(n.externalPlugin),s=c.next(),Q.label=11;case 11:return s.done?[3,14]:(l=s.value,f=l.payload,h=l.signature,[4,Ge(this.transport,f,h)]);case 12:Q.sent(),Q.label=13;case 13:return s=c.next(),[3,11];case 14:return[3,17];case 15:return d=Q.sent(),H={error:d},[3,17];case 16:try{s&&!s.done&&(z=c.return)&&z.call(c)}finally{if(H)throw H.error}return[7];case 17:Q.trys.push([17,22,23,24]),v=De(n.nfts),y=v.next(),Q.label=18;case 18:return y.done?[3,21]:(g=y.value,[4,Me(this.transport,Ue.from(g,"hex"))]);case 19:Q.sent(),Q.label=20;case 20:return y=v.next(),[3,18];case 21:return[3,24];case 22:return b=Q.sent(),V={error:b},[3,24];case 23:try{y&&!y.done&&(K=v.return)&&K.call(v)}finally{if(V)throw V.error}return[7];case 24:Q.trys.push([24,29,30,31]),S=De(n.erc20Tokens),E=S.next(),Q.label=25;case 25:return E.done?[3,28]:(m=E.value,[4,Fe(this.transport,Ue.from(m,"hex"))]);case 26:Q.sent(),Q.label=27;case 27:return E=S.next(),[3,25];case 28:return[3,31];case 29:return w=Q.sent(),W={error:w},[3,31];case 30:try{E&&!E.done&&(q=S.return)&&q.call(S)}finally{if(W)throw W.error}return[7];case 31:x=Ue.from(t,"hex"),I=p(x),T=I.vrsOffset,P=I.txType,_=I.chainId,A=I.chainIdTruncated,N=u(e),O=0,U=function(){var e,t,n,r;return Re(this,(function(o){switch(o.label){case 0:return t=(e=0===O)?149-4*N.length:150,n=O+t>x.length?x.length-O:t,0!=T&&O+n>=T&&(n=x.length-O),r=Ue.alloc(e?1+4*N.length+n:n),e?(r[0]=N.length,N.forEach((function(e,t){r.writeUInt32BE(e,1+4*t)})),x.copy(r,1+4*N.length,O,O+n)):x.copy(r,0,O,O+n),[4,k.transport.send(224,4,e?0:128,0,r).catch((function(e){throw function(e){return e&&27264===e.statusCode?new ae("Please enable Blind signing or Contract data in the Ethereum app Settings"):e}(e)}))];case 1:return C=o.sent(),O+=n,[2]}}))},k=this,Q.label=32;case 32:return O===x.length?[3,34]:[5,U()];case 33:return Q.sent(),[3,32];case 34:return R=C[0],D="",_.times(2).plus(35).plus(1).isGreaterThan(255)?(B=(2*A+35)%256,L=Math.abs(R-B),D=null!=P?L%2==1?"00":"01":_.times(2).plus(35).plus(L).toString(16)):D=R.toString(16),D.length%2==1&&(D="0"+D),F=C.slice(1,33).toString("hex"),M=C.slice(33,65).toString("hex"),[2,{v:D,r:F,s:M}]}}))}))},e.prototype.getAppConfiguration=function(){return this.transport.send(224,6,0,0).then((function(e){return{arbitraryDataEnabled:1&e[0],erc20ProvisioningNecessary:2&e[0],starkEnabled:4&e[0],starkv2Supported:8&e[0],version:e[1]+"."+e[2]+"."+e[3]}}))},e.prototype.signPersonalMessage=function(e,t){return ke(this,void 0,void 0,(function(){var n,r,o,a,i,c,s,l,f;return Re(this,(function(h){switch(h.label){case 0:n=u(e),r=0,o=Ue.from(t,"hex"),i=function(){var e,t,i;return Re(this,(function(u){switch(u.label){case 0:return e=0===r?149-4*n.length-4:150,t=r+e>o.length?o.length-r:e,i=Ue.alloc(0===r?1+4*n.length+4+t:t),0===r?(i[0]=n.length,n.forEach((function(e,t){i.writeUInt32BE(e,1+4*t)})),i.writeUInt32BE(o.length,1+4*n.length),o.copy(i,1+4*n.length+4,r,r+t)):o.copy(i,0,r,r+t),[4,c.transport.send(224,8,0===r?0:128,0,i)];case 1:return a=u.sent(),r+=t,[2]}}))},c=this,h.label=1;case 1:return r===o.length?[3,3]:[5,i()];case 2:return h.sent(),[3,1];case 3:return s=a[0],l=a.slice(1,33).toString("hex"),f=a.slice(33,65).toString("hex"),[2,{v:s,r:l,s:f}]}}))}))},e.prototype.signEIP712HashedMessage=function(e,t,n){return function(e,t,n,r){var o=s(n),a=s(r),i=u(t),c=we.alloc(1+4*i.length+32+32,0),l=0;return c[0]=i.length,i.forEach((function(e,t){c.writeUInt32BE(e,1+4*t)})),l=1+4*i.length,o.copy(c,l),l+=32,a.copy(c,l),e.send(224,12,0,0,c).then((function(e){return{v:e[0],r:e.slice(1,33).toString("hex"),s:e.slice(33,65).toString("hex")}}))}(this.transport,e,t,n)},e.prototype.signEIP712Message=function(e,t,n){return void 0===n&&(n=!1),ke(this,void 0,void 0,(function(){return Re(this,(function(r){return[2,Oe(this.transport,e,t,n,this.loadConfig)]}))}))},e.prototype.starkGetPublicKey=function(e,t){var n=u(e),r=Ue.alloc(1+4*n.length);return r[0]=n.length,n.forEach((function(e,t){r.writeUInt32BE(e,1+4*t)})),this.transport.send(240,2,t?1:0,0,r).then((function(e){return e.slice(0,e.length-2)}))},e.prototype.starkSignOrder=function(e,t,n,r,o,a,i,c,s,f,h){var d=l(t),p=l(r),v=u(e),y=Ue.alloc(1+4*v.length+20+32+20+32+4+4+8+8+4+4,0),g=0;return y[0]=v.length,v.forEach((function(e,t){y.writeUInt32BE(e,1+4*t)})),g=1+4*v.length,d&&d.copy(y,g),g+=20,Ue.from(n.toString(16).padStart(64,"0"),"hex").copy(y,g),g+=32,p&&p.copy(y,g),g+=20,Ue.from(o.toString(16).padStart(64,"0"),"hex").copy(y,g),g+=32,y.writeUInt32BE(a,g),g+=4,y.writeUInt32BE(i,g),g+=4,Ue.from(c.toString(16).padStart(16,"0"),"hex").copy(y,g),g+=8,Ue.from(s.toString(16).padStart(16,"0"),"hex").copy(y,g),g+=8,y.writeUInt32BE(f,g),g+=4,y.writeUInt32BE(h,g),this.transport.send(240,4,1,0,y).then((function(e){return{r:e.slice(1,33).toString("hex"),s:e.slice(33,65).toString("hex")}}))},e.prototype.starkSignOrder_v2=function(e,t,n,r,o,a,i,c,s,f,h,d,p,v,y){var g=l(t),b=l(a);if(!(n in Be))throw new Error("eth.starkSignOrderv2 invalid source quantization type="+n);if(!(i in Be))throw new Error("eth.starkSignOrderv2 invalid destination quantization type="+i);var S=u(e),E=Ue.alloc(1+4*S.length+1+20+32+32+1+20+32+32+4+4+8+8+4+4,0),m=0;return E[0]=S.length,S.forEach((function(e,t){E.writeUInt32BE(e,1+4*t)})),m=1+4*S.length,E[m]=Be[n],m++,g&&g.copy(E,m),m+=20,r&&Ue.from(r.toString(16).padStart(64,"0"),"hex").copy(E,m),m+=32,o&&Ue.from(o.toString(16).padStart(64,"0"),"hex").copy(E,m),E[m+=32]=Be[i],m++,b&&b.copy(E,m),m+=20,c&&Ue.from(c.toString(16).padStart(64,"0"),"hex").copy(E,m),m+=32,s&&Ue.from(s.toString(16).padStart(64,"0"),"hex").copy(E,m),m+=32,E.writeUInt32BE(f,m),m+=4,E.writeUInt32BE(h,m),m+=4,Ue.from(d.toString(16).padStart(16,"0"),"hex").copy(E,m),m+=8,Ue.from(p.toString(16).padStart(16,"0"),"hex").copy(E,m),m+=8,E.writeUInt32BE(v,m),m+=4,E.writeUInt32BE(y,m),this.transport.send(240,4,3,0,E).then((function(e){return{r:e.slice(1,33).toString("hex"),s:e.slice(33,65).toString("hex")}}))},e.prototype.starkSignTransfer=function(e,t,n,r,o,a,i,c,f){var h=l(t),d=s(r),p=u(e),v=Ue.alloc(1+4*p.length+20+32+32+4+4+8+4+4,0),y=0;return v[0]=p.length,p.forEach((function(e,t){v.writeUInt32BE(e,1+4*t)})),y=1+4*p.length,h&&h.copy(v,y),y+=20,Ue.from(n.toString(16).padStart(64,"0"),"hex").copy(v,y),y+=32,d.copy(v,y),y+=32,v.writeUInt32BE(o,y),y+=4,v.writeUInt32BE(a,y),y+=4,Ue.from(i.toString(16).padStart(16,"0"),"hex").copy(v,y),y+=8,v.writeUInt32BE(c,y),y+=4,v.writeUInt32BE(f,y),this.transport.send(240,4,2,0,v).then((function(e){return{r:e.slice(1,33).toString("hex"),s:e.slice(33,65).toString("hex")}}))},e.prototype.starkSignTransfer_v2=function(e,t,n,r,o,a,i,c,f,h,d,p,v){var y=l(t),g=s(a),b=l(p);if(!(n in Be))throw new Error("eth.starkSignTransferv2 invalid quantization type="+n);var S=u(e),E=Ue.alloc(1+4*S.length+1+20+32+32+32+4+4+8+4+4+(b?52:0),0),m=0;return E[0]=S.length,S.forEach((function(e,t){E.writeUInt32BE(e,1+4*t)})),m=1+4*S.length,E[m]=Be[n],m++,y&&y.copy(E,m),m+=20,r&&Ue.from(r.toString(16).padStart(64,"0"),"hex").copy(E,m),m+=32,o&&Ue.from(o.toString(16).padStart(64,"0"),"hex").copy(E,m),m+=32,g.copy(E,m),m+=32,E.writeUInt32BE(i,m),m+=4,E.writeUInt32BE(c,m),m+=4,Ue.from(f.toString(16).padStart(16,"0"),"hex").copy(E,m),m+=8,E.writeUInt32BE(h,m),m+=4,E.writeUInt32BE(d,m),b&&v&&(m+=4,Ue.from(v.toString(16).padStart(64,"0"),"hex").copy(E,m),m+=32,b.copy(E,m)),this.transport.send(240,4,b?5:4,0,E).then((function(e){return{r:e.slice(1,33).toString("hex"),s:e.slice(33,65).toString("hex")}}))},e.prototype.starkProvideQuantum=function(e,t){var n=l(e),r=Ue.alloc(52,0);return n&&n.copy(r,0),Ue.from(t.toString(16).padStart(64,"0"),"hex").copy(r,20),this.transport.send(240,8,0,0,r).then((function(){return!0}),(function(e){if(e&&27904===e.statusCode)return!1;throw e}))},e.prototype.starkProvideQuantum_v2=function(e,t,n,r){var o=l(e);if(!(t in Be))throw new Error("eth.starkProvideQuantumV2 invalid quantization type="+t);var a=Ue.alloc(84,0),i=0;return o&&o.copy(a,i),i+=20,n&&Ue.from(n.toString(16).padStart(64,"0"),"hex").copy(a,i),i+=32,r&&Ue.from(r.toString(16).padStart(64,"0"),"hex").copy(a,i),this.transport.send(240,8,Be[t],0,a).then((function(){return!0}),(function(e){if(e&&27904===e.statusCode)return!1;throw e}))},e.prototype.starkUnsafeSign=function(e,t){var n,r=s(t),o=u(e),a=Ue.alloc(1+4*o.length+32);return a[0]=o.length,o.forEach((function(e,t){a.writeUInt32BE(e,1+4*t)})),n=1+4*o.length,r.copy(a,n),this.transport.send(240,10,0,0,a).then((function(e){return{r:e.slice(1,33).toString("hex"),s:e.slice(33,65).toString("hex")}}))},e.prototype.eth2GetPublicKey=function(e,t){var n=u(e),r=Ue.alloc(1+4*n.length);return r[0]=n.length,n.forEach((function(e,t){r.writeUInt32BE(e,1+4*t)})),this.transport.send(224,14,t?1:0,0,r).then((function(e){return{publicKey:e.slice(0,-2).toString("hex")}}))},e.prototype.eth2SetWithdrawalIndex=function(e){var t=Ue.alloc(4,0);return t.writeUInt32BE(e,0),this.transport.send(224,16,0,0,t).then((function(){return!0}),(function(e){if(e&&27904===e.statusCode)return!1;throw e}))},e.prototype.getEIP1024PublicEncryptionKey=function(e,t){var n=u(e),r=Ue.alloc(1+4*n.length);return r[0]=n.length,n.forEach((function(e,t){r.writeUInt32BE(e,1+4*t)})),this.transport.send(224,24,t?1:0,0,r).then((function(e){return{publicKey:e.slice(0,-2).toString("hex")}}))},e.prototype.getEIP1024SharedSecret=function(e,t,n){var r,o=u(e),a=s(t),i=Ue.alloc(1+4*o.length+32);return i[0]=o.length,o.forEach((function(e,t){i.writeUInt32BE(e,1+4*t)})),r=1+4*o.length,a.copy(i,r),this.transport.send(224,24,n?1:0,1,i).then((function(e){return{sharedSecret:e.slice(0,-2).toString("hex")}}))},e.prototype.provideERC20TokenInformation=function(e){var t=e.data;return Fe(this.transport,t)},e.prototype.setExternalPlugin=function(e,t,n){return console.warn("hw-app-eth: eth.setExternalPlugin is deprecated. signTransaction solves this for you when providing it in `resolution`."),Ge(this.transport,e,n)},e.prototype.setPlugin=function(e){return console.warn("hw-app-eth: eth.setPlugin is deprecated. signTransaction solves this for you when providing it in `resolution`."),je(this.transport,e)},e}();function Fe(e,t){return e.send(224,10,0,0,t).then((function(){return!0}),(function(e){if(e&&27904===e.statusCode)return!1;throw e}))}function Me(e,t){return e.send(224,20,0,0,t).then((function(){return!0}),(function(e){if(e&&27904===e.statusCode)throw new ie;throw e}))}function Ge(e,t,n){var r=Ue.from(t,"hex"),o=Ue.from(n,"hex"),a=Ue.concat([r,o]);return e.send(224,18,0,0,a).then((function(){return!0}),(function(e){if(e&&27264===e.statusCode)return!1;if(e&&27012===e.statusCode)return!1;if(e&&27904===e.statusCode)return!1;throw e}))}function je(e,t){var n=Ue.from(t,"hex");return e.send(224,22,0,0,n).then((function(){return!0}),(function(e){if(e&&27264===e.statusCode)return!1;if(e&&27012===e.statusCode)return!1;if(e&&27904===e.statusCode)return!1;throw e}))}}}]);